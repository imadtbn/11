<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù…Ø´ØªÙ„Ø© Ø§Ù„Ø³Ù„Ø§Ù… â€” Ø§Ù„Ù…ØªØ¬Ø±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Ø®Ø· Ø¹Ø±Ø¨ÙŠ -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;font-family:'Cairo',sans-serif;margin:0;padding:0}
    body{background:#f9fdf9;color:#222;line-height:1.6}
    header{background:#2e7d32;color:#fff;padding:1rem;position:sticky;top:0;z-index:1000}
    header .top{display:flex;justify-content:space-between;align-items:center}
    header h1{font-size:1.5rem}
    .search-bar{margin-top:.7rem;display:flex;gap:.5rem;align-items:center;background:#fff;border-radius:6px;padding:.3rem .6rem}
    .search-bar input{flex:1;border:none;outline:none;padding:.4rem;font-size:1rem}
    .search-bar i{color:#2e7d32}
    .cart-bar{background:#e8f5e9;padding:.6rem 1rem;margin-top:.7rem;display:flex;justify-content:space-between;align-items:center;
      border:1px solid #c8e6c9;border-radius:6px;position:sticky;top:80px;z-index:999}
    .cart-bar button{background:#2e7d32;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;font-weight:bold;cursor:pointer}
    .category{margin:2rem 1rem}
    .category-header{border-bottom:3px solid #2e7d32;margin-bottom:1rem}
    .products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem}
    .card{background:#fff;border:1px solid #eee;border-radius:8px;overflow:hidden;display:flex;flex-direction:column;
      box-shadow:0 2px 6px rgba(0,0,0,.05);transition:transform .2s}
    .card:hover{transform:translateY(-4px)}
    .card img{width:100%;height:150px;object-fit:cover}
    .card h3{padding:.5rem;font-size:1.1rem;color:#2e7d32}
    .card p{padding:0 .5rem .5rem}
    .card button{margin:.5rem;background:#43a047;color:#fff;border:none;padding:.5rem;border-radius:6px;cursor:pointer}
    .card button:hover{background:#2e7d32}
    /* Ø§Ù„Ø³Ù„Ø© */
    #cartModal{position:fixed;top:0;right:0;width:380px;max-width:100%;height:100%;background:#fff;box-shadow:-2px 0 6px rgba(0,0,0,.2);
      transform:translateX(100%);transition:transform .3s ease-in-out;z-index:2000;display:flex;flex-direction:column}
    #cartModal.active{transform:translateX(0)}
    #cartModal header{background:#2e7d32;color:#fff;padding:.8rem;display:flex;justify-content:space-between;align-items:center}
    #cartItems{flex:1;overflow-y:auto;padding:1rem}
    .cart-item{display:flex;align-items:center;margin-bottom:1rem;border-bottom:1px solid #eee;padding-bottom:.5rem}
    .cart-item img{width:50px;height:50px;object-fit:cover;border-radius:6px;margin-left:.5rem}
    .cart-item h4{flex:1;font-size:.9rem}
    .cart-item input{width:50px;text-align:center}
    .cart-item button{background:none;border:none;color:red;cursor:pointer;font-size:1.2rem}
    .cart-actions{padding:1rem;border-top:1px solid #eee}
    .cart-actions button{margin:.3rem 0;width:100%;padding:.6rem;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
    .empty-btn{background:#c62828;color:#fff}
    .checkout-btn{background:#2e7d32;color:#fff}
    /* Toast */
    .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#2e7d32;color:#fff;
      padding:.7rem 1.2rem;border-radius:6px;opacity:0;pointer-events:none;transition:opacity .3s,transform .3s;z-index:3000}
    .toast.show{opacity:1;pointer-events:auto;transform:translate(-50%,-10px)}
    /* Footer */
    footer{background:#2e7d32;color:#dfeede;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:1rem;padding:1.5rem;margin-top:2rem}
    footer h4{margin-bottom:.6rem}
    footer a{display:block;color:#fff;margin:.3rem 0;text-decoration:none}
    footer a i{margin-left:.3rem}
    /* Responsive */
    @media(max-width:600px){
      .products{grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}
      #cartModal{width:100%}
    }
  </style>
</head>
<body>
  <header>
    <div class="top">
      <h1><i class="fas fa-seedling"></i> Ù…Ø´ØªÙ„Ø© Ø§Ù„Ø³Ù„Ø§Ù…</h1>
      <div><i class="fas fa-phone"></i> 0697 743 721</div>
    </div>
    <div class="search-bar">
      <i class="fas fa-search"></i>
      <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬...">
    </div>
    <div class="cart-bar">
      <span>ğŸ›’ <span id="cartCount">0</span> Ù…Ù†ØªØ¬ | ğŸ’° <span id="cartTotal">0</span> Ø¯Ø¬</span>
      <button onclick="toggleCart()"><i class="fas fa-shopping-cart"></i> Ø¹Ø±Ø¶ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
    </div>
  </header>

  <main id="categories-container"></main>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ù„Ø© -->
  <div id="cartModal">
    <header>
      <h2><i class="fas fa-shopping-cart"></i> Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
      <button onclick="toggleCart()" style="background:none;border:none;color:#fff;font-size:1.3rem"><i class="fas fa-times"></i></button>
    </header>
    <div id="cartItems"></div>
    <div class="cart-actions">
      <button class="empty-btn" onclick="emptyCart()"><i class="fas fa-trash"></i> Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©</button>
      <input id="customerName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†" style="width:100%;margin:.3rem 0;padding:.5rem">
      <input id="customerPhone" type="text" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" style="width:100%;margin:.3rem 0;padding:.5rem">
      <button class="checkout-btn" onclick="checkout('whatsapp')"><i class="fab fa-whatsapp"></i> Ø¥ØªÙ…Ø§Ù… Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
      <button class="checkout-btn" onclick="checkout('google')"><i class="fas fa-credit-card"></i> Ø¥ØªÙ…Ø§Ù… Ø¹Ø¨Ø± Google</button>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <footer>
    <div>
      <h4>Ù…Ø´ØªÙ„Ø© Ø§Ù„Ø³Ù„Ø§Ù…</h4>
      <p>Ø£Ø¬ÙˆØ¯ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø´ØªÙ„Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</p>
      <a href="#"><i class="fas fa-map-marker-alt"></i> ØªÙˆØ¬Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´ØªÙ„</a>
    </div>
    <div>
      <h4><i class="fas fa-map"></i> Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</h4>
      <p>Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù… - Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</p>
      <h4><i class="fas fa-phone"></i> Ø§Ù„Ù‡Ø§ØªÙ</h4>
      <p>0697 743 721</p>
    </div>
    <div>
      <h4>ØªØ§Ø¨Ø¹Ù†Ø§</h4>
      <a href="#"><i class="fab fa-facebook"></i> ÙÙŠØ³Ø¨ÙˆÙƒ</a>
      <a href="#"><i class="fab fa-instagram"></i> Ø¥Ù†Ø³ØªØºØ±Ø§Ù…</a>
      <a href="#"><i class="fab fa-whatsapp"></i> ÙˆØ§ØªØ³Ø§Ø¨</a>
    </div>
    <div>
      <h4><i class="fas fa-cogs"></i> Ø®Ø¯Ù…Ø§ØªÙ†Ø§</h4>
      <p>ğŸŒ± Ø¨ÙŠØ¹ Ø§Ù„Ø´ØªÙ„Ø§Øª</p>
      <p>ğŸšš Ø§Ù„ØªÙˆØµÙŠÙ„</p>
      <p>ğŸ› ï¸ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</p>
    </div>
  </footer>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbxMYSinB7TRS-wtpunBOT9Telb6pKAMvuRTWfc12elRnvcwsO0VUT1s0arOfG-S9-vPHA/exec";
let cart=[];let products=[];

async function loadProducts(){
  try{
    const res=await fetch(API_URL+"?sheet=products");
    products=await res.json();
    renderProducts(products);
  }catch(e){console.error(e);}
}
function renderProducts(list){
  const container=document.getElementById("categories-container");
  container.innerHTML="";
  const grouped={};
  list.forEach(p=>{
    const cat=(p["Ø§Ù„ÙØ¦Ø© "]||"ØºÙŠØ± Ù…ØµÙ†Ù").trim();
    (grouped[cat] ||= []).push(p);
  });
  Object.entries(grouped).forEach(([catName,items])=>{
    const section=document.createElement("section");
    section.className="category";
    section.innerHTML=`<div class="category-header"><h2>${catName}</h2></div><div class="products"></div>`;
    items.forEach(p=>{
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`
        <img src="${p["Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©"]||'https://via.placeholder.com/200'}">
        <h3>${p["Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"]}</h3>
        <p>Ø§Ù„Ø³Ø¹Ø±: ${p["Ø§Ù„Ø³Ø¹Ø± "]} Ø¯Ø¬</p>
        <button onclick='addToCart(${JSON.stringify(p)})'><i class="fas fa-cart-plus"></i> Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>`;
      section.querySelector(".products").appendChild(card);
    });
    container.appendChild(section);
  });
}
function addToCart(p){
  const found=cart.find(it=>it.id===p.id);
  if(found){found.qty++;} else {cart.push({id:p.id,name:p["Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"],price:p["Ø§Ù„Ø³Ø¹Ø± "],img:p["Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©"],qty:1});}
  updateCartUI();
  showToast(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${p["Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"]} Ù„Ù„Ø³Ù„Ø©`);
}
function updateCartUI(){
  document.getElementById("cartCount").innerText=cart.length;
  let total=cart.reduce((s,it)=>s+it.price*it.qty,0);
  document.getElementById("cartTotal").innerText=total;
  const cartItems=document.getElementById("cartItems");
  cartItems.innerHTML="";
  cart.forEach((it,i)=>{
    const div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`<img src="${it.img||'https://via.placeholder.com/50'}">
      <h4>${it.name}</h4>
      <input type='number' min=1 value='${it.qty}' onchange='changeQty(${i},this.value)'>
      <span>${it.price*it.qty} Ø¯Ø¬</span>
      <button onclick='removeItem(${i})'><i class="fas fa-trash"></i></button>`;
    cartItems.appendChild(div);
  });
}
function changeQty(i,v){cart[i].qty=parseInt(v)||1;updateCartUI();}
function removeItem(i){cart.splice(i,1);updateCartUI();}
function emptyCart(){cart=[];updateCartUI();}
function toggleCart(){document.getElementById("cartModal").classList.toggle("active");}
function checkout(type){
  const name=document.getElementById("customerName").value.trim();
  const phone=document.getElementById("customerPhone").value.trim();
  if(!name||!phone){alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");return;}
  const items=cart.map(it=>`${it.name} x${it.qty}`).join(", ");
  const total=cart.reduce((s,it)=>s+it.price*it.qty,0);
  // send to Sheets
  fetch(API_URL,{method:"POST",body:JSON.stringify({action:"addOrder",customerName:name,phone:phone,items:items,total:total,status:"Ø¬Ø¯ÙŠØ¯"})});
  if(type==="whatsapp"){
    const msg=`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:%0AğŸ‘¤ ${name}%0AğŸ“ ${phone}%0AğŸ›’ ${items}%0AğŸ’° ${total} Ø¯Ø¬`;
    window.open(`https://wa.me/213697743721?text=${msg}`,"_blank");
  }else{alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…ØªØ¬Ø±");}
  emptyCart();toggleCart();
}
function showToast(msg){
  const t=document.getElementById("toast");
  t.innerText=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2500);
}
// Ø§Ù„Ø¨Ø­Ø«
document.getElementById("searchInput").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  const filtered=products.filter(p=>p["Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"].toLowerCase().includes(q));
  renderProducts(filtered.length?filtered:products);
});
loadProducts();
</script>
</body>
</html>
